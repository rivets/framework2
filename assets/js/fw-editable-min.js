fwdom.popover=null,fwdom.inline=null,fwdom.domid=-1,fwdom.edOptions=[],fwdom.makeEdit=function(e){const o=fwdom.edOptions[e.getAttribute("data-editable-id")];let t=e.innerText,d;switch(t===o.emptyText&&(t=""),o.type){case"select":d='<select class="edbox">';for(let e of o.source)d+="<option"+(e==t?" selected":"")+">"+e+"</option>";d+="</select>";break;case"textarea":d='<textarea rows="5" cols="25" class="edbox">'+t+"</textarea>";break;default:d='<input type="'+o.type+'" value="'+t+'" class="edbox"/>';break}return d+'<i class="fas fa-times-circle edno"></i><i class="fas fa-check-circle edyes"></i>'},fwdom.popDispose=function(){document.body.removeEventListener("click",fwdom.outsideClick),null!==fwdom.popover&&(fwdom.popover.dispose(),fwdom.popover=null)},fwdom.outsideClick=function(e){fwdom.inline==e.target||fwdom.inline==fwdom.popover.tip||fwdom.popover.tip.contains(e.target)||fwdom.popDispose(e)},fwdom.editUpdate=function(e,o){return console.log(e),framework.ajax(framework.buildFWLink("ajax",e.op,e.bean,e.key,e.field),{method:putorpatch,data:{value:o}})},fwdom.editable=function(e,o=null){let t={type:"text",emptyText:"------",title:"Edit String",update:null};if(null!=o)for(let e in o)t[e]=o[e];let d=e.dataset;for(let e in d)t[e]=d[e];fwdom.domid+=1,fwdom.edOptions[fwdom.domid]=t,console.log(fwdom.edOptions),e.setAttribute("data-editable-id",fwdom.domid),""===e.innerText&&(e.innerText=t.emptyText,e.classList.add("edempty")),e.addEventListener("click",(function(o){fwdom.stop(o),null!==fwdom.inline&&fwdom.popDispose();let d=new bootstrap.Popover(e,{title:t.title,html:!0,sanitize:!1,content:fwdom.makeEdit(this),placement:"auto",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'});d.show();let i=d.tip;i.querySelector(".edno").addEventListener("click",fwdom.popDispose),i.querySelector(".edyes").addEventListener("click",(function(e){fwdom.stop(e);let o=fwdom.edOptions[fwdom.inline.getAttribute("data-editable-id")],t=i.querySelector(".edbox");t.value!=fwdom.inline.innerText&&(null==o.update?fwdom.alert("No update function defined"):o.update(o,t.value).done((function(e){console.log(e),""===t.value?(fwdom.inline.innerText=o.emptytext,fwdom.inline.classList.add("edempty")):(fwdom.inline.innerText=t.value,fwdom.inline.classList.remove("edempty"))})).fail((function(e){console.log(e),fwdom.alert("Update failed")}))),fwdom.popDispose()})),document.body.addEventListener("click",fwdom.outsideClick),fwdom.popover=d,fwdom.inline=e}))};
//# sourceMappingURL=fw-editable-min.js.map